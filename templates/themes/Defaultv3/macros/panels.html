{% import "themes/" + sysSettings.systemTheme + "/macros/cards.html" as cards with context %}
{% import "themes/" + sysSettings.systemTheme + "/macros/core_ui.html" as core_ui with context %}

{% macro announcement_panel(title, message) %}
<div class="announcement-container boxShadow">
    <div class="float-end">
      <button type="button" class="btn-close" aria-label="Close"></button>
    </div>
    <h3 class="textShadow"><b>{{ title }}</b></h3>
    <p>{{ message }}</p>
</div>
{% endmacro %}

{% macro live_streams_panel(streamList, title="Currently Live") %}
<div class="live-container boxShadow">
  <h3 class="textShadow"><b>{{ title }}</b></h3>
  <ul id="topStreamList" class="mb-2 itemList d-flex flex-wrap justify-content-start" style="width:100%">
      {% for stream in streamList %}
        {{ cards.live_stream_card(stream) }}
      {% endfor %}
  </ul>
</div>
{% endmacro %}

{% macro topics_panel(topicList, title="Topics" ) %}
<div class="topics-container insetBoxShadow">
  <h3 class="textShadow"><b>{{ title }}</b></h3>
  <ul id="topicList" class="itemList d-flex flex-wrap justify-content-start" style="width:100%">
  {% for topic in topicList %}
    {{ cards.topic_card(topic) }}
  {% endfor %}
  </ul>
</div>
{% endmacro %}

{% macro streamer_panel(streamerList, title="Streamers" ) %}
<div class="streamer-container insetBoxShadow">
  <h3 class="textShadow"><b>{{ title }}</b></h3>
  <ul id="streamerList" class="itemList d-flex flex-wrap justify-content-start" style="width:100%">
  {% for streamer in streamerList %}
    {{ cards.streamer_card(streamer) }}
  {% endfor %}
  </ul>
</div>
{% endmacro %}

{% macro channels_panel(channelList, title="Channels" ) %}
<div class="channels-container insetBoxShadow">
  <h3 class="textShadow"><b>{{ title }}</b></h3>
  <ul id="channelList" class="itemList d-flex flex-wrap justify-content-start" style="width:100%">
  {% for channel in channelList %}
    {{ cards.channel_card(channel) }}
  {% endfor %}
  </ul>
</div>
{% endmacro %}

{% macro videos_panel(videoList, title="Videos", heightOverride=False) %}
<div class="videos-container boxShadow {% if heightOverride == True %}h-100{% endif %}">
  <h3 class="textShadow"><b>{{ title }}</b></h3>
  <ul id="videoList" class="mb-2 itemList d-flex flex-wrap justify-content-start" style="width:100%">
      {% for video in videoList %}
          {{ cards.video_card(video) }}
      {% endfor %}
  </ul>
</div>
{% endmacro %}

{% macro clips_panel(clipsList, title="Clips") %}
<div class="clips-container boxShadow">
  <h3 class="textShadow"><b>{{ title }}</b></h3>
  <ul id="clipList" class="mb-2 itemList d-flex flex-wrap justify-content-start" style="width:100%">
      {% for clip in clipsList %}
          {{ cards.clip_card(clip) }}
      {% endfor %}
  </ul>
</div>
{% endmacro %}

{% macro featured_streamer_panel(data) %}
<div class="featured-stream-container insetBoxShadow">
  <h1 class="textShadow"><b>Featured Stream</b></h1>
  <div class="row">
    <div class="col-sm-12 col-md-5">
      <img class="w-100 boxShadow" src="/static/img/sample/fakelive.gif">
    </div>
    <div class="col-sm-12 col-md-7">
      <div class="stream-metadata ms-4">
        <div class="card mb-3" style="max-width: 540px;">
          <div class="row g-0">
            <div class="col-2">
              <img class="mt-3 userImage boxShadow img-fluid rounded-circle" src="https://i.pravatar.cc/62?u=theuser2pravatar.com" alt="Username Picture">
            </div>
            <div class="col-10">
              <div class="card-body">
                <p class="card-text textShadow">
                  <b>Stream Name</b><br>
                  Streamer Username<br>
                  Stream Topic
                </p>
                <span class="live-badge boxShadow textShadow"><b>Live</b></span>
                <span class="live-viewers-badge boxShadow textShadow ms-1"><i class="bi bi-eye-fill pe-1"></i> <b class="justify-content-end">40201</b></span>
              </div>
            </div>
          </div>
        </div>
        <div class="stream-metadata-description">
          Lorem ipsum dolor sit, amet consectetur adipisicing elit. Quisquam nostrum deserunt beatae possimus autem aspernatur, temporibus dolore labore laudantium quaerat, ducimus neque fuga, repellat dolorem et earum corporis odit! Blanditiis.
        </div>
      </div>
    </div>
  </div>
</div>
{% endmacro %}

{% macro user_bio_panel(userData) %}
<div class="streamer-info-container insetBoxShadow">
  <div class="row">
    <div class="col-auto">
      <img class="steamer-info-picture-img rounded-circle boxShadow" src="/images/{{userData.pictureLocation}}" alt="User Photo">
    </div>
    <div class="col">
      <div class="user-metadata align-top">
        <span class="fs-4 textShadow"><b>{{userData.username}}</b></span><br>
        <span class="socialIcons">
            <a href="#"><img class="socialIcon boxShadow" src="https://cdn3.iconfinder.com/data/icons/popular-services-brands/512/facebook-512.png"></a>
            <a href="#"><img class="socialIcon boxShadow" src="https://cdn4.iconfinder.com/data/icons/social-media-icons-the-circle-set/48/twitter_circle-512.png"></a>
            <a href="#"><img class="socialIcon boxShadow" src="https://cdn.fastly.picmonkey.com/content4/previews/social/social_53_550.png"></a>
            <a href="#"><img class="socialIcon boxShadow" src="https://icons-for-free.com/iconfiles/png/512/instagram+photos+round+icon+social+media+social+network+icon-1320190505735536578.png"></a>
        </span>
      </div>
    </div>
    {% if userData.biography != None and userData.biography != "" and userData.biography != "None" %}
    <span class="fs-5 mt-4 textShadow">{{userData.biography|markdown}}</span>
    {% endif %}
  </div>
</div>
{% endmacro %}

{% macro channel_metadata_panel(channelData) %}
<div class="channel-info-container insetBoxShadow">
  <div class="row">
    <div class="col-auto">
      <img class="channel-info-picture-img boxShadow" src="/images/{{channelData.imageLocation}}" width="100%" onerror="this.src='/static/img/video-placeholder.jpg';">
    </div>
    <div class="col">
      <div class="channel-metadata align-top">
        <div class="fs-4 textShadow"><b>{{ channelData.channelName }}</b></div>
        <div class="textShadow"><a href="#"><b>{{ channelData.owningUser|get_userName }}</b></a></div>
        <div class="channelBadges">
          {% if channelData.id | get_channelLiveStatus %}
            {{ core_ui.live_badge() }}
          {% else %}
            {{ core_ui.offline_badge() }}
          {% endif %}
          {% if channelData.protected and sysSettings.protectionEnabled %}
            {{ core_ui.protected_badge() }}
          {% endif %}
        </div>
        <div class="channelButtons">
          <a href="/view/{{ channelData.channelLoc }}" class="btn btn-primary btn-sm boxShadow textShadow me-2"><b>View Live Channel</b></a>
          {% if current_user.is_authenticated %}
          <button type="button" class="btn btn-success btn-sm boxShadow textShadow"><b><i class="bi bi-star-fill"></i> Subscribe</b></button>
          {% endif %}
        </div>
      </div>
    </div>
    {% if channelData.description != None and channelData.description != "" and channelData.description != "None" %}
    <span class="fs-5 mt-4 textShadow">{{channelData.description|markdown}}</span>
    {% endif %}
  </div>
</div>
{% endmacro %}

{% macro video_metadata_panel(video) %}
<div class="video-metadata">
  <div class="row">
    <div class="channelImg-sm col-auto">
      <img src="/images/{{ video.channelID | get_channelPicture}}" onerror="this.src='/static/img/video-placeholder.jpg';">
    </div>
    <div class="col-5">
      <div class="video-name">{{ video.channelName }}</div>
      <div class="video-channelName">{{ video.channelID | get_channelName }}</div>
      <div class="video-topic">{{ video.topic | get_topicName }}</div>
    </div>
    <div class="col">
      <div class="float-end mx-1">
        <i class="bi bi-people-fill"></i> {{ video.views }}
      </div>
    </div>
  </div>
</div>
{% endmacro %}

{% macro video_player(videoURL, videoThumbnail, isAutoPlay=True) %}
<div class="player">
    <video id="video" class="shadow video-js vjs-big-play-centered" poster="/videos/{{videoThumbnail}}" {% if isAutoPlay == True %}autoplay{% endif %} controls playsinline preload="auto" data-setup='{"fluid": true}'>
        <source src="{{videoURL}}" type="video/mp4">
        <p class="vjs-no-js">
          To view this video please enable JavaScript, and consider upgrading to a web browser that
          <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
        </p>
    </video>
</div>
{% endmacro %}

{% macro video_control_panel(streamURL, video, current_user) %}
<div class="video-control-panel boxShadow">
    {%  if current_user.is_authenticated and video.owningUser == current_user.id %}
    <!--Start Video Owner Controls-->
    <div class="video-control-owner-buttons pt-2 ms-1 float-start">
        <a href="{{streamURL}}" class="btn btn-primary boxShadow" data-toggle="tooltip" data-placement="top" title="Download Video" download><i class="fas fa-download"></i></a>
        <button type="button" class="btn btn-primary boxShadow" onclick="newThumbnailRequest();"><i class="fas fa-camera"></i></button>
        <button type="button" class="btn btn-primary boxShadow" onclick="openModal('moveModal');" data-toggle="tooltip" data-placement="top" title="Move to Another Channel"><i class="fas fa-arrow-circle-right"></i></button>
        <button type="button" class="btn btn-primary boxShadow" onclick="openClipModal();"><i class="fas fa-cut"></i></button>
        <button type="button" class="btn btn-primary boxShadow" onclick="openModal('editModal');"><i class="fas fa-edit"></i></button>
        <button type="button" class="btn btn-danger boxShadow" onclick="openModal('deleteModal');"><i class="fas fa-trash-alt"></i></button>
    </div>
    {% endif %}
    <!--Start Video Viewer Controls-->
    <div class="video-control-viewer-buttons pt-2 me-1 float-end">
        <button class="btn btn-primary boxShadow" onclick="openModal('shareModal');"><i class="fas fa-share-alt"></i></button>
        <button id="upvoteButton" type="button" class="btn btn-outline-success boxShadow" data-toggle="tooltip" data-placement="top" title="Upvote" onclick="changeUpvote('video',{{video.id}});" title="Upvote" {% if current_user.is_authenticated==false %} disabled aria-disabled="true" {% endif %}>
            <i id="upVoteIcon" class="far fa-thumbs-up"></i> <span id="totalUpvotes"></span>
        </button>
        {% if current_user.is_authenticated %}
            <button id="chanSubStateButton" class="btn boxShadow {% if subState == True %} btn-success {% else %} btn-outline-success {% endif %}" onclick='toggleChannelSub("{{video.channelID}}")'>{% if subState == True %}<i class="fas fa-star"></i><span class="d-none d-sm-none d-md-inline"> Unsubscribe</span>{% else %}<i class="far fa-star"></i><span class="d-none d-sm-none d-md-inline"> Subscribe</span>{% endif %}</button>
        {% else %}
            <button class="btn btn-outline-secondary disabled boxShadow" disabled><i class="far fa-star"></i><span class="d-none d-sm-none d-md-inline"> Subscribe</span></button>
        {% endif %}
    </div>
</div>
{% endmacro %}

{% macro comments_panel(commentList, videoAllowComments, systemAllowComments) %}
<div id="commentsContainer" class="comments-container boxShadow">
  <div class="comments-header-container boxShadow">
    <span class="fs-3 textShadow"><b>Comments</b></span>
    <span class="float-end me-3 mt-1" onclick="openModal('commentModal');"><i class="text-center fs-4 bi bi-plus-square"></i></span>
  </div>
  <div class="comments-content-container">
    {% for comment in commentList %}
        {{ cards.comment_card(comment) }}
    {% endfor %}
  </div>
</div>
{% endmacro %}

{% macro user_settings_panel(userData, channelUsage, sysSettings) %}
<div class="info-panel-box system-appearance-box">
    <div class="info-panel-box-header boxShadow textShadow">
        <b>User Settings</b>
    </div>
    <div class="info-panel-box-body boxShadow">
        <form action="/settings/user" enctype=multipart/form-data method="post">
            <div class="row">
                <div class="col-12 col-md-6">
                     <div class="row">
                        <div class="col-auto">
                            <div class="streamer-avatar">
                                <img class="userPhoto rounded-circle boxShadow" src="/images/{{userData.pictureLocation}}" onerror="this.src='/static/img/user2.png';">
                            </div>
                            <div class="file-upload mt-1">
                              <input type="file" name="photo" class="form-control boxShadow" id="userphotoupload">
                            </div>
                        </div>
                        <div class="col-10 mt-2">
                            <div class="form-group">
                                <label for="userName"><b>User Name</b></label>
                                <input type="text" name="userName" id="userName" class="form-control boxShadow" value="{{userData.username}}" disabled>
                            </div>
                        </div>
                        <div class="form-group mt-2">
                            <label for="emailAddress"><b>Email Address</b></label>
                            <input type="email" name="emailAddress" id="emailAddress" class="form-control boxShadow" value="{{userData.email}}" required>
                        </div>
                        <hr class="mt-2">
                        {% if current_user.authType == 0 %}
                        <div>
                            <b>Two Factor Authentication Status:</b> {%  if userData.tf_primary_method == "authenticator" %} <span style="color:green">Enabled</span> {% else %} <span style="color:red">Disabled</span>{% endif %}<br>
                            <a href="/tf-setup" class="btn btn-success boxShadow">Configure 2FA</a>
                        </div>
                        <hr class="mt-2">
                        <div class="form-group">
                            <label for="password"><b>Change Password</b></label>
                            <input type="password" id="password" class="form-control boxShadow" name="password1" placeholder="New Password">
                        </div>
                        <div class="form-group mt-2">
                            <input type="password" id="password2" class="form-control boxShadow" name="password2" placeholder="Confirm New Password">
                        </div>
                        {% endif %}
                        <hr class="mt-2">
                        <div class="form-group">
                            <label for="biography" class="col-form-label"><b>Biography</b></label>
                            <textarea class="form-control boxShadow" name="biography" id="biography-{{userData.id}}" value="" maxlength="2048">{{userData.biography}}</textarea>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <b>XMPP Access</b>
                    <p>To access the chat with an external Jabber Client, use this login information:</p>
                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                            <b>Username: </b>
                        </div>
                        <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                            {{userData.uuid}}@{{sysSettings.siteAddress}}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                            <b>Password: </b>
                        </div>
                        <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                            <div class="input-group">
                                  <div class="input-group-prepend">
                                      <button type="button" class="btn btn-primary" onclick="CopyAPI('xmppToken')"><i class="fas fa-copy"></i></button>
                                  </div>
                                  <input type="text" name="xmppToken" id="xmppToken" class="form-control" readonly value="{{userData.xmppToken}}">
                            </div>
                        </div>
                    </div>
                    <hr>
                    <b>Storage Usage</b>
                    <div class="mt-2">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Channel Name</th>
                                    <th>Usage</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for chan in channelUsage %}
                                <tr>
                                    <td>{{ chan['name'] }}</td>
                                    <td>{{ chan['usage'] | formatSpace }}</td>
                                </tr>
                                {% endfor %}
                                <tr>
                                    <td></td>
                                    <td>{{ totalSpaceUsed | formatSpace }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 p-2">
                    <hr class="mt-2">
                    <button type="submit" class="btn btn-primary boxShadow">Submit</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script>
    var easymde_UserBio = new EasyMDE({ autoDownloadFontAwesome: false, spellChecker: false, element: document.getElementById("biography-{{userData.id}}") });
</script>
{% endmacro %}

{% macro live_stream(channel)%}
 <div class="player ml-2">
     <div id="videoContainer">
         <video id="video" class="shadow videoStream video-js vjs-big-play-centered" poster="/stream-thumb/{{channel.channelLoc}}.png" autoplay controls playsinline preload="auto" data-setup='{"fluid": true, "liveui": true}'>
            <p class="vjs-no-js">
              To view this video please enable JavaScript, and consider upgrading to a web browser that
              <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
            </p>
         </video>
     </div>
     <div id="offlineImage" style="display:none;">
        <img class="videoStream shadow" {% if channel.offlineImageLocation != None %} src="/images/{{channel.offlineImageLocation}}" {% else %} src="/static/img/video-placeholder.jpg" {% endif %} onerror="this.onerror=null;this.src='/static/img/video-placeholder.jpg';">
     </div>
 </div>
{% endmacro %}

{% macro stream_control_panel(channel, current_user) %}
<div class="stream-control-panel boxShadow">
    {%  if current_user.is_authenticated and channel.owningUser == current_user.id %}
    <!--Start Stream Owner Controls-->
    <div class="stream-control-owner-buttons pt-2 ms-1 float-start">
        <button type="button" class="btn btn-primary boxShadow" onclick="openModal('editModal');"><i class="fas fa-edit"></i></button>
    </div>
    {% endif %}
    <!--Start Stream Viewer Controls-->
    <div class="stream-control-viewer-buttons pt-2 me-1 float-end">
        <button class="btn btn-primary boxShadow" onclick="openModal('shareModal');"><i class="fas fa-share-alt"></i></button>
        <button id="upvoteButton" type="button" class="btn btn-outline-success boxShadow" data-toggle="tooltip" data-placement="top" title="Upvote" onclick="changeUpvote('stream',{{channel.id}});" title="Upvote" {% if current_user.is_authenticated==false %} disabled aria-disabled="true" {% endif %}>
            <i id="upVoteIcon" class="far fa-thumbs-up"></i> <span id="totalUpvotes"></span>
        </button>
        {% if current_user.is_authenticated %}
            <button id="chanSubStateButton" class="btn boxShadow {% if subState == True %} btn-success {% else %} btn-outline-success {% endif %}" onclick='toggleChannelSub("{{channel.id}}")'>{% if subState == True %}<i class="fas fa-star"></i><span class="d-none d-sm-none d-md-inline"> Unsubscribe</span>{% else %}<i class="far fa-star"></i><span class="d-none d-sm-none d-md-inline"> Subscribe</span>{% endif %}</button>
        {% else %}
            <button class="btn btn-outline-secondary disabled boxShadow" disabled><i class="far fa-star"></i><span class="d-none d-sm-none d-md-inline"> Subscribe</span></button>
        {% endif %}
        <span class="ml-2">
            <span class="btn btn-danger boxShadow" id="liveIndicatorBadge">LIVE</span>
        </span>
    </div>
</div>
{% endmacro %}

{% macro stream_metadata_panel(channel, stream) %}
<div class="stream-metadata">
  <div class="row">
    <div class="channelImg-sm col-auto">
      <img src="/images/{{ channel.id | get_channelPicture}}" onerror="this.src='/static/img/video-placeholder.jpg';">
    </div>
    <div class="col-5">
      <div class="channel-name">{{ channel.channelName }}</div>
      <div id="streamMetadataName" class="mr-5"><b><i class="fas fa-video"></i> {% if stream != None %} {{stream.streamName}} {% else %} No Stream {% endif %}</b></div>
      <div id="streamMetadataTopic"><b><i class="fas fa-hashtag"></i><a href="/topic/{{stream.topic}}/">{% if stream != None %} {{stream.topic|get_topicName}} {% else %} {{channel.topic|get_topicName}} {% endif %}</a></b></div>
    </div>
    <div class="col">
      <div class="float-end mx-1">
        <i class="bi bi-people-fill"></i> {{ channel.views }}
      </div>
    </div>
  </div>
</div>
{% endmacro %}

{% macro chat_loader() %}
<div id="loader" class="chatloader">
  <div class="chatloader-view">
      <h2>Connecting...</h2>
      <div class="d-flex justify-content-center">
          <div class="spinner-border" role="status">
            <span class="sr-only">Loading...</span>
          </div>
      </div>
  </div>
</div>
{% endmacro %}

{% macro chat_guest_username_input() %}
<div id="guestUserName" class="chatloader">
    <div class="chatloader-view">
          <div class="vertical-center">
                <div class="d-flex justify-content-center my-3">
                    <h2>Set your Nickname</h2><br>
                </div>
                <div class="d-flex justify-content-center">
                    <b>Enter name you wish to be identified by:</b>
                </div>
                <div class="d-flex justify-content-center px-3">
                    <input class="form-control shadow" id="setNickName" name="setNickName">
                </div>
                <div class="d-flex justify-content-center my-4">
                    <button type="button" class="btn btn-primary boxShadow m-1" onclick="setGuestNickLogin();">Connect</button>
                    <a href="/login" class="btn btn-success boxShadow m-1">Log in</a>
                </div>
          </div>
    </div>
</div>
{% endmacro %}

{% macro chat_unavailable_info() %}
<div id="unavailable" class="chatloader">
  <div class="chatloader-view">
      <h2>You have been disconnected from the chat.</h2><br>
      <br>
      <div id="disconnectReason">Reason: (<span id="reasonCode"></span>) - <span id="reasonText"></span></div><br><br>
      <h1><i class="fas fa-exclamation-triangle"></i></h1><br>
      <br>
      <button class="btn btn-success" onclick="connectChat();">Reconnect</button>
  </div>
</div>
{% endmacro %}

{% macro core_chat_header() %}
<div class="chatHeader flex d-flex justify-content-between mb-2 p-2">
    <span class="chat-header-left"><button type="button" class="btn btn-link mx-2" onclick="popoutChat();"><i class="fas fa-external-link-alt"></i></button></span>
    <span class="chat-header-center fs-4 textShadow">Live Chat</span>
    <span class="chat-header-right">
        <span id="channelList"><button type="button" class="btn btn-link" onclick="showOccupants();"><i class="fas fa-user-friends"></i> <span id="chatTotal"></span></button></span>
        <span id="modDisplayButton" style="display:none;"><button type="button" class="btn btn-link" onclick="openModDisplay();"><i class="fas fa-user-shield"></i></button></span>
    </span>
</div>
{% endmacro %}

{% macro core_chat_mod_view() %}
<div id="modDisplay" class="modDisplayOverlay">
    <div class="membersList card my-3">
      <div class="card-header bg-primary"><b>Banned Users</b></div>
      <div id="OutcastList" class="card-body"></div>
    </div>
</div>
{% endmacro %}

{% macro core_chat_members_view() %}
<div id="chatMembers" class="chatMembersOverlay">
  <div class="membersList card my-3">
      <div class="card-header bg-primary"><b>Moderator</b></div>
      <div id="ModeratorList" class="card-body"></div>
  </div>
  <div class="membersList card my-3">
      <div class="card-header bg-primary"><b>Participant</b></div>
      <div id="ParticipantList" class="card-body"></div>
  </div>
  <div class="membersList card my-3">
      <div class="card-header bg-primary"><b>Guest</b></div>
      <div id="VisitorList" class="card-body"></div>
  </div>
</div>
{% endmacro %}

{% macro core_chat_sticker_selector(stickerSelectorList) %}
<div class="chatsticker-composer-popover chatsticker-composer-emoji-popover shadow">
 <div class="chatsticker-emoji-picker w-100">
    <div class="chatsticker-composer-popover-header"><input class="chatsticker-composer-popover-input" placeholder="Search..." aria-label="Search" value="" oninput="searchSticker();"></div>
    <div class="chatsticker-composer-popover-body-container">
       <div class="chatsticker-composer-popover-body">
          <div class="chatsticker-emoji-picker-groups">
             <div class="chatsticker-emoji-picker-group">
                 <div class="chatsticker-emoji-picker-group-title">Default</div>
                 {% for sticker in stickerSelectorList['builtin'] %}
                <span class="chatsticker-emoji-picker-emoji" title="{{ sticker.name }}"><img src="{{ sticker.file }}" height="32px" alt="{{ sticker.name }}" title="{{ sticker.name }}" /></span>
                 {% endfor %}
             </div>
             <div class="chatsticker-emoji-picker-group">
                <div class="chatsticker-emoji-picker-group-title">Global</div>
                 {% for sticker in stickerSelectorList['global'] %}
                <span class="chatsticker-emoji-picker-emoji" title="{{ sticker.name }}"><img src="{{ sticker.file }}" height="32px" alt="{{ sticker.name }}" title="{{ sticker.name }}" /></span>
                 {% endfor %}
             </div>
             <div class="chatsticker-emoji-picker-group">
                 <div class="chatsticker-emoji-picker-group-title">Channel</div>
                 {% for sticker in stickerSelectorList['channel'] %}
                <span class="chatsticker-emoji-picker-emoji" title="{{ sticker.name }}"><img src="{{ sticker.file }}" height="32px" alt="{{ sticker.name }}" title="{{ sticker.name }}" /></span>
                 {% endfor %}
             </div>
          </div>
       </div>
    </div>
 </div>
 <div class="chatsticker-composer-popover-caret"></div>
</div>
{% endmacro %}

{% macro core_chat_footer(stickerSelectorList) %}
<div class="chatFooter flex-end pl-1 mb-1">
  <div class="chatFooterTop"></div>
  <div class="chatFooterInput mx-2">
      <div class="input-group">
          <input id="chatinput" type="text" class="form-control chatInputBox boxShadow" maxlength="750" autocomplete="off">
          <button type="button" class="btn btn-success boxShadow" id="openEmojiButton"><i class="far fa-smile"></i></button>
          <button type="button" class="btn btn-primary boxShadow" id="sendChat" onclick="sendMessage();"><i class="fas fa-paper-plane"></i></button>
          {{ core_chat_sticker_selector(stickerSelectorList) }}
      </div>
  </div>
  <div class="chatFooterBottom"></div>
  <div id='log' style="display:none;"></div>
</div>
{% endmacro %}

{% macro core_chat(stickerSelectorList) %}
<div id="chatPanel" class="chatPanel h-100">
    {{ core_chat_header() }}
    <div id="chatContentWindow" class="chatContent h-100">
        {{ core_chat_mod_view() }}
        {{ core_chat_members_view() }}
        <div id="chat" class="chatSection"></div>
    </div>
    {{ core_chat_footer(stickerSelectorList) }}
  </div>
</div>
{% endmacro %}

{% macro core_chat_message_template() %}
<div class="chatEntryContainer" data-type="chatmessagetemplate" style="display:none;">
    <div class="chatEntry boxShadow flexbox">
      <span class="chatInfo">
        <div><span class="chatTimestamp float-end"></span></div>
        <div><span class="chatUsername"></span></div>
        <div><span class="chatMessage"></span></div>
      </span>
    </div>
</div>
{% endmacro %}

{% macro core_chat_profile_template() %}
<div id="profileBox" class="rounded profileBox shadow m-2" data-type="profileBoxTemplate" style="display:none;">
  <div class="profileBoxHeader">
    <div class="float-end">
       <button type="button" class="btn-close mt-2 me-2" data-bs-dismiss="" aria-label="Close" onclick="closeProfileBox();"></button>
    </div>
    <div class="row">
      <div class="col-auto">
        <img id="profileBox-photo" src="/static/img/user2.png" class="profileBoxPic rounded shadow my-2">
      </div>
      <div class="col-9 g-0 mt-2">
        <span id="profileBox-username" class="font-weight-bold"></span><br>
        <span class="profileBox-iconBar" id="iconBar">
          <span class="iconBarIcon" id="iconBar-owner" style="display:none;"><i class="fas fa-crown" data-toggle="tooltip" data-placement="bottom" title="Owner"></i></span>
          <span class="iconBarIcon" id="iconBar-admin" style="display:none;"><i class="fas fa-user-tie" data-toggle="tooltip" data-placement="bottom" title="Admin"></i></span>
          <span class="iconBarIcon" id="iconBar-member" style="display:none;"><i class="iconBarIcon fas fa-award" data-toggle="tooltip" data-placement="bottom" title="Member"></i></span>
          <span class="iconBarIcon" id="iconBar-mod" style="display:none;"><i class="iconBarIcon fas fa-user-shield" data-toggle="tooltip" data-placement="bottom" title="Moderator"></i></span>
          <span class="iconBarIcon" id="iconBar-voice" style="display:none;"><i class="iconBarIcon fas fa-bullhorn" data-toggle="tooltip" data-placement="bottom" title="Participant"></i></span>
          <span class="iconBarIcon" id="iconBar-visitor" style="display:none;"><i class="fas fa-user" data-toggle="tooltip" data-placement="bottom" title="Visitor"></i></span>
          <span class="iconBarIcon" id="iconBar-muted" style="display:none;"><i class="iconBarIcon fas fa-comment-slash" data-toggle="tooltip" data-placement="bottom" title="Muted"></i></span>
        </span>
      </div>
    </div>
  </div>
  <div class="profileBoxBottom mt-2 mx-2">
    <button id="profileBox-openProfileButton" type="button" class="btn btn-primary shadow">Profile</button>
    <button id="profileBox-muteButton" class="btn btn-primary shadow" onclick="toggleMute();"><i class="fas fa-toggle-off"></i> Mute</button>
    <div id="profileBox-modControls" class="dropdown dropstart float-end" style="display:none;">
      <button class="btn btn-secondary dropdown-toggle shadow" type="button" id="dropdownMenuButtonProfileBox" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fas fa-ellipsis-v"></i></button>
      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
          <h6 class="dropdown-header">Mod Controls</h6>
          <button class="dropdown-item" type="button" onclick="modKick();">Kick</button>
          <button class="dropdown-item" type="button" onclick="modBan();">Ban</button>
          <div class="dropdown-divider"></div>
          <h6 class="dropdown-header">Change Role</h6>
          <button class="dropdown-item" type="button" onclick="modSetAffiliation('admin');">Set as Moderator</button>
          <button class="dropdown-item" type="button" onclick="modSetAffiliation('member');">Set as Participant</button>
          <button class="dropdown-item" type="button" onclick="modSetAffiliation('none');">Set as Guest</button>
          <div class="dropdown-divider"></div>
          <h6 class="dropdown-header">Channel Voice Controls</h6>
          <!--<button class="dropdown-item" type="button" onclick="modSetRole('moderator');">Set as Moderator</button>-->
          <button class="dropdown-item" type="button" onclick="modSetRole('participant');">Voice</button>
          <button class="dropdown-item" type="button" onclick="modSetRole('visitor');">Devoice</button>
      </ul>
    </div>
  </div>
</div>
{% endmacro %}