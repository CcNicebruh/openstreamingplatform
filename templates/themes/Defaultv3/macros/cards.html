{% import "themes/" + sysSettings.systemTheme + "/macros/core_ui.html" as core_ui with context %}

{% macro live_stream_card(stream) %}
<li class="streamCard item">
    <a href="/view/{{ stream.linkedChannel | get_channelLocationFromID }}/">
        <div class="streamCard-badges">
            {{ core_ui.live_badge() }}
            {{ core_ui.live_views_badge(stream.currentViewers) }}
        </div>
        <img class="streamCard-thumb boxShadow gif lazy" {% if stream.linkedChannel | get_channelProtected and sysSettings.protectionEnabled %} src="/static/img/video-locked.jpg" onerror="this.src='/static/img/video-locked.jpg';" {% else %} src="/static/img/video-placeholder.jpg" onerror="this.src='/static/img/video-placeholder.jpg';" {% endif %} data-src="/stream-thumb/{{ stream.linkedChannel | get_channelLocationFromID }}.png">
        <div class="card mb-3" style="max-width: 540px;">
            <div class="row g-0">
              <div class="col-2">
                <img class="mt-3 userImage boxShadow img-fluid rounded-circle" src="/images/{{ stream.linkedChannel | channeltoOwnerID | get_pictureLocation }}" onerror="this.src='/static/img/user2.png';">
              </div>
              <div class="col-10">
                <div class="card-body">
                  <p class="card-text textShadow">
                    <b>{{ stream.streamName | limit_title }}</b><br>
                    {{ stream.linkedChannel | channeltoOwnerID | get_userName }}<br>
                    {{ stream.topic | get_topicName }}
                  </p>
                </div>
              </div>
            </div>
        </div>
    </a>
</li>
{% endmacro %}

{% macro video_card(video) %}
<li class="streamCard item">
  <a href="/play/{{video.id}}">
    <div class="streamCard-thumbnail-container zoom">
        <div class="streamCard-badges">
            {{ core_ui.views_badge(video.views) }}
            {{ core_ui.length_badge(video.length) }}
        </div>
        <img class="streamCard-thumb boxShadow lazy {% if video.gifLocation != None %}gif{% endif %}" src="/static/img/video-placeholder.jpg" data-src="/videos/{{video.thumbnailLocation}}" onerror="this.src='/static/img/video-placeholder.jpg';">
    </div>
    <div class="card mb-3" style="max-width: 540px;">
        <div class="row g-0">
          <div class="col-2">
            <img class="mt-3 userImage boxShadow img-fluid rounded-circle" src="/images/{{video.owningUser | get_pictureLocation}}" onerror="this.src='/static/img/user2.png';" alt="Username Picture">
          </div>
          <div class="col-10">
            <div class="card-body">
              <p class="card-text textShadow">
                <b>{{ video.channelName | limit_title }}</b><br>
                   {{ video.owningUser | get_userName }}<br>
                   {{ video.topic | get_topicName }}
              </p>
            </div>
          </div>
        </div>
    </div>
  </a>
</li>
{% endmacro %}

{% macro clip_card(clip) %}
<li class="streamCard item">
  <a href="/clip/{{clip.id}}">
    <div class="streamCard-thumbnail-container zoom">
        <div class="streamCard-badges">
            {{ core_ui.views_badge(clip.views) }}
        </div>
        <img class="streamCard-thumb boxShadow lazy {% if clip.gifLocation != None %}gif{% endif %}" src="/static/img/video-placeholder.jpg" data-src="/videos/{{clip.thumbnailLocation}}" onerror="this.src='/static/img/video-placeholder.jpg';">
    </div>
    <div class="card mb-3" style="max-width: 540px;">
        <div class="row g-0">
          <div class="col-2">
            <img class="mt-3 userImage boxShadow img-fluid rounded-circle" src="/images/{{ clip.parentVideo | videotoChannelID | channeltoOwnerID  | get_pictureLocation}}" onerror="this.src='/static/img/user2.png';" alt="Username Picture">
          </div>
          <div class="col-10">
            <div class="card-body">
              <p class="card-text textShadow">
                <b>{{ clip.clipName | limit_title }}</b><br>
                   {{ clip.parentVideo | videotoChannelID | channeltoOwnerID | get_userName }}<br>
                   {{ clip.parentVideo | get_videoTopic | get_topicName }}
              </p>
            </div>
          </div>
        </div>
    </div>
  </a>
</li>
{% endmacro %}

{% macro topic_card(topic) %}
    <a href="/topic/{{topic.id}}/">
        <li class="topicCard item">
          <div class="topicImg"><img class="lazy zoom" src="/images/{{topic.iconClass}}" onerror="this.src='/static/img/video-placeholder.jpg';" alt="{{ topic.name }}"></div>
          <div class="topicName"><b>{{ topic.name }}</b></div>
        </li>
    </a>
{% endmacro %}

{% macro streamer_card(streamerInfo) %}
    <a href="/streamer/{{ streamerInfo.id }}">
        <li class="streamer-avatar">
          <img class="shadow zoom" src="/images/{{ streamerInfo.pictureLocation }}" onerror="this.src='/static/img/user2.png';">
          <div class="username"><b>{{ streamerInfo.username }}</b></div>
        </li>
    </a>
{% endmacro %}

{% macro channel_card(channelData) %}
<li class="channelCard item">
    <a href="/channel/{{channelData.id}}/">
    <div class="zoom">
        <div class="channelCard-badges">
        {% if channelData.id | get_channelLiveStatus %}
            {{ core_ui.live_badge() }}
        {% endif %}
        {% if channelData.protected and sysSettings.protectionEnabled %}
            {{ core_ui.protected_badge() }}
        {% endif %}
        {{ core_ui.views_badge(channelData.currentViewers) }}
        </div>
        <div class="channelImg"><img class="lazy" src="/images/{{ channelData.imageLocation }}" onerror="this.src='/static/img/video-placeholder.jpg';" alt="{{ channelData.name }}"></div>
    </div>
    <div class="channelMetadata mt-2">
        <div class="row">
            <div class="col-3">
                <img class="mt-2 userImage boxShadow img-fluid rounded-circle" src="/images/{{ channelData.owningUser | get_pictureLocation }}" alt="{{ channelData.channelName }} Picture" onerror="this.src='/static/img/user2.png';">
            </div>
            <div class="col-9">
                <div class="channelName"><b>{{ channelData.channelName }}</b></div>
                <div class="channelOwner">
                  <b>{{ channelData.owningUser | get_userName }}</b>
                </div>
            </div>
        </div>
    </div>
    </a>
</li>
{% endmacro %}

{% macro comment_card(comment) %}
<div class="comment">
  <div class="row gx-0">
    <div class="comment-avatar col-1 mt-2">
        <img class="avatar-md mx-2 boxShadow" src="/images/{{ comment.userID | get_pictureLocation }}" onerror="this.src='/static/img/user2.png';">
    </div>
    <div class="col-11 mt-2">
      <div class="comment-header">
        <span><b><a href="/profile/{{ comment.userID | get_userName }}">{{ comment.userID | get_userName }}</a></b></span>
        <span class="float-end me-2"><i class="bi bi-calendar-date"></i> {{ comment.timestamp | normalize_date }}</span><br>
        <span class=mt-1>{{ comment.comment | markdown }}</span>
      </div>
    </div>
  </div>
</div>
{% endmacro %}

{% macro user_settings_video_card(video) %}
<li id="video-{{video.id}}" class="channelVideoCard p-2 p-md-0 m-0 m-md-2">
    <div class="row">
      <div class="col-auto m-2 pt-2">
        <div class="mb-2" style="width:270px;">
          <img class="boxShadow {% if video.gifLocation != None %}gif{% endif %} lazy" id="videoThumb-{{video.id}}" src="/static/img/video-placeholder.jpg" data-src="/videos/{{video.thumbnailLocation}}" onerror="this.src='/static/img/video-placeholder.jpg';" style="max-width:100%;max-height:100%;border-radius:6px;">
        </div>
        <div class="d-grid gap-2">
            <button type="button" class="btn btn-success boxShadow videoThumbnailUploadModalButton" data-bs-toggle="modal" data-bs-target="#videoThumbnailUploadModal" data-videoid="{{video.id}}">Upload Thumbnail</button>
        </div>
        <div class="mt-2">
          <button class="videoMoveModalButton btn btn-primary boxShadow" data-bs-toggle="modal" data-bs-target="#videoMoveModal" data-videoid="{{video.id}}" data-toggle="tooltip" data-placement="top" title="Move Video"><i class="fas fa-arrow-circle-right"></i></button>
          <button class="btn btn-primary boxShadow" data-bs-toggle="modal" onclick="openClipModal('{{video.id}}', '/videos/{{video.videoLocation}}');" data-toggle="tooltip" data-placement="top" title="Create Clip"><i class="fas fa-cut"></i></button>
          <button class="videoEditModalButton btn btn-primary boxShadow" data-bs-toggle="modal" data-bs-target="#videoEditModal" data-videoid="{{video.id}}" data-toggle="tooltip" data-placement="top" title="Edit Metadata"><i class="fas fa-edit"></i></button>
          <button class="btn btn-primary boxShadow" data-bs-toggle="modal" onclick="openSSModal('{{video.id}}', '/videos/{{video.videoLocation}}');" data-toggle="tooltip" data-placement="top" title="Set Thumbnail"><i class="fas fa-camera"></i></button>
          <button class="videoShareModalButton btn btn-primary boxShadow" data-bs-toggle="modal" data-bs-target="#videoShareModal" data-videoid="{{video.id}}" data-toggle="tooltip" data-placement="top" title="Share Video"><i class="fas fa-share-alt"></i></button>
          <button class="videoDeleteModalButton btn btn-danger boxShadow" data-bs-toggle="modal" data-bs-target="#videoDeleteModal" data-videoid="{{video.id}}" data-toggle="tooltip" data-placement="top" title="Delete Video"><i class="fas fa-trash-alt"></i></button>
        </div>
      </div>
      <div class="col mt-3">
        <h5><a href="/play/{{video.id}}"><span id="vidName-{{video.id}}">{{video.channelName}}</span></a></h5>
        <div class="mb-1">
            <div class="btn-group boxShadow" role="group">
              <span type="button" class="btn btn-sm btn-success noClickButton min-35"><i class="fas fa-hashtag"></i></span>
              <span id="vidTopicText-{{video.id}}" class="btn btn-sm btn-dark noClickButton min-100">{{video.topic|get_topicName}}</span>
            </div>
        </div>
        <div class="my-1">
            <div class="btn-group boxShadow" role="group">
              <button type="button" class="btn btn-sm btn-primary noClickButton min-35"><i class="fas fa-calendar"></i></button>
              <button type="button" class="btn btn-sm btn-dark noClickButton min-100">{{video.videoDate|normalize_date}}</button>
            </div>
        </div>
        <div class="my-1">
            <div class="btn-group boxShadow" role="group">
              <button type="button" class="btn btn-sm btn-danger noClickButton min-35"><i class="fas fa-clock"></i></button>
              <button type="button" class="btn btn-sm btn-dark noClickButton min-100">{{video.length|hms_format}}</button>
            </div>
        </div>
        <span id="vidTopic-{{video.id}}" class="d-none">{{video.topic}}</span>
        <span id="vidDescription-{{video.id}}" class="d-none">{{video.description}}</span>
        <span id="vidAllowComments-{{video.id}}" class="d-none">{{video.allowComments}}</span>
        <div class="my-1">
            <div class="btn-group boxShadow" role="group">
              <button type="button" class="btn btn-sm btn-primary noClickButton min-35"><i class="fas fa-users"></i></button>
              <button type="button" class="btn btn-sm btn-dark noClickButton min-100">{{video.views}}</button>
            </div>
        </div>
        <div class="my-1">
            <div class="btn-group boxShadow" role="group">
              <button type="button" class="btn btn-sm btn-primary noClickButton min-35"><i class="far fa-thumbs-up"></i></button>
              <button type="button" class="btn btn-sm btn-dark noClickButton min-100">{{video.upvotes|length}}</button>
            </div>
        </div>
        <div class="my-1">
            <div class="btn-group boxShadow" role="group">
              <button type="button" class="btn btn-sm btn-primary noClickButton min-35"><i class="far fa-comment-alt"></i></button>
              <button type="button" class="btn btn-sm btn-dark noClickButton min-100">{{video.comments|length}}</button>
            </div>
        </div>
        <div class="form-group row">
            <div class="col-6">
                <div class="form-check form-switch">
                  <label for="published-{{video.id}}"><b>Published?</b></label>
                  <input class="form-check-input" type="checkbox" id="published-{{video.id}}" name="publishedSelect" onchange="togglePublished('{{video.id}}')" {% if video.published == True %} checked {% endif %}>
                </div>
            </div>
        </div>
      </div>
    </div>
</li>
{% endmacro %}

{% macro user_settings_clip_card(clip) %}
<li id="clip-{{clip.id}}" class="channelVideoCard shadow p-2 p-md-0 m-0 m-md-2">
    <div class="row">
      <div class="col-auto m-2 pt-3">
        <div class="mb-2" style="width:270px;">
          <img class="shadow {% if clip.gifLocation != None %}gif{% endif %} lazy" id="clipThumb-{{clip.id}}" src="/static/img/video-placeholder.jpg" data-src="/videos/{{clip.thumbnailLocation}}" onerror="this.src='/static/img/video-placeholder.jpg';" style="max-width:100%;max-height:100%;">
        </div>
        <div class="mt-2">
          <button class="clipEditModalButton btn btn-primary shadow" data-toggle="modal" data-target="#clipEditModal" data-clipid="{{clip.id}}"><i class="fas fa-edit"></i></button>
          <button class="btn btn-primary shadow" data-toggle="modal" onclick="openClipSSModal('{{clip.id}}', '{{clip.recordedVideo.id}}', '/videos/{{clip.videoLocation}}');"><i class="fas fa-camera"></i></button>
          <button class="clipShareModalButton btn btn-primary shadow" data-toggle="modal" data-target="#videoShareModal" data-clipid="{{clip.id}}"><i class="fas fa-share-alt"></i></button>
          <button class="clipDeleteModalButton btn btn-danger shadow" data-toggle="modal" data-target="#clipDeleteModal" data-clipid="{{clip.id}}"><i class="fas fa-trash-alt"></i></button>
        </div>
      </div>
      <div class="col mt-2">
        <h4><a href="/clip/{{clip.id}}"><span id="clipName-{{clip.id}}">{{clip.clipName}}</span></a></h4>
        <h5><i class="fas fa-hashtag mr-2"></i><span id="clipTopicText-{{clip.id}}">{{clip.recordedVideo.topic|get_topicName}}</span></h5>
        <h5><i class="far fa-calendar-alt mr-2"></i>{{clip.recordedVideo.videoDate|normalize_date}}</h5>
        <h5><i class="far fa-clock mr-1"></i>{{clip.length|hms_format}}</h5>
        <span id="clipDescription-{{clip.id}}" class="d-none">{{clip.description}}</span>
        <h5><i class="fas fa-users"></i> {{clip.views}}</h5>
        <h5><i class="far fa-thumbs-up"></i> {{clip.upvotes|length}}</h5>
        <div class="form-group row">
            <div class="col-6">
                <label for="clipPublished-{{clip.id}}" class="col-form-label"><b>Published? </b></label>
            </div>
            <div class="col-6">
                <input type="checkbox" data-toggle="toggle" id="clipPublished-{{clip.id}}" name="publishedSelect" onchange="togglePublishedClip('{{clip.id}}')" {% if clip.published == True %} checked {% endif %}>
            </div>
        </div>
      </div>
    </div>
</li>
{% endmacro %}